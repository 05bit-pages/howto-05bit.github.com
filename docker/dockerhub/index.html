<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>How To</title>
    <link rel="icon" type="image/png" href="/favicon.png?_=1" />
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css?_=1">
    <link rel="stylesheet" href="/assets/css/pygments.css">
    <link rel="stylesheet" href="/assets/css/docta.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
</head>
<body>

<nav class="navbar navbar-default navbar-static-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            
            <a class="navbar-brand logo" href="/" style="background-image: url(/assets/img/question.svg); width: 55px; background-size: 65%;"></a>
            
            <a class="navbar-brand" href="/">How To</a>
        </div>

        
    </div>
</nav>


<div class="container">
    <div class="row">
        <div class="col-sm-9">
            
    <h1>How to run DockerHub on start?</h1>
<p>Create the DockerHub start script with <code>sudo vi /usr/local/bin/docker-hub-start</code>:</p>
<div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>
<span class="nv">IP_ADDR</span><span class="o">=</span><span class="sb">`</span>/usr/bin/dig +short f7458dd3-64ea-47b4-833c-8d340b12637d.priv.cloud.scaleway.com<span class="sb">`</span>
/usr/bin/docker run --rm -p <span class="si">${</span><span class="nv">IP_ADDR</span><span class="si">}</span>:5000:5000 --name registry registry:2
</pre></div>
<p>Set exec permissions to the script:</p>
<div class="highlight"><pre><span></span>sudo chmod +x /usr/local/bin/docker-hub-start
</pre></div>
<p>Create DockerHub systemd service definition to with <code>sudo vi /etc/systemd/system/docker-hub.service</code>:</p>
<div class="highlight"><pre><span></span><span class="k">[Unit]</span>
<span class="na">Description</span><span class="o">=</span><span class="s">DockerHub service</span>
<span class="na">Requires</span><span class="o">=</span><span class="s">docker.service</span>
<span class="na">After</span><span class="o">=</span><span class="s">docker.service</span>

<span class="k">[Service]</span>
<span class="na">Restart</span><span class="o">=</span><span class="s">always</span>
<span class="na">ExecStart</span><span class="o">=</span><span class="s">/usr/local/bin/docker-hub-start</span>
<span class="na">ExecStop</span><span class="o">=</span><span class="s">/usr/bin/docker stop -t 2 registry</span>

<span class="k">[Install]</span>
<span class="na">WantedBy</span><span class="o">=</span><span class="s">default.target</span>
</pre></div>
<p>Run the service:</p>
<div class="highlight"><pre><span></span>sudo systemctl start docker-hub
</pre></div>


        </div>
        <div class="col-sm-3">
            
            <div class="panel panel-default">
                <div class="panel-body">
                    <ul class="nav nav-pills nav-stacked nav-tree">
                        <li >
                            <a href="/" class="index">How To</a>
                            <hr>
                        </li>
                        
                            
                            <li>
                                <a href="/linux/" class="index">Linux Tips</a>
                                
                            </li>
                            
                            <li>
                                <a href="/macos/" class="index">macOS Tips</a>
                                
                            </li>
                            
                            <li>
                                <a href="/services/" class="index">Services</a>
                                
                            </li>
                            
                            <li>
                                <a href="/shell/" >Shell Tips</a>
                                
                            </li>
                            
                            <li>
                                <a href="/sublime/" >SublimeText3</a>
                                
                            </li>
                            
                            <li>
                                <a href="/docker/" class="index">Docker</a>
                                
                                <ul class="nav nav-pills nav-stacked">
                                    
                                    <li class="active">
                                        <a href="/docker/dockerhub/">Dockerhub</a>
                                    </li>
                                    
                                </ul>
                                
                            </li>
                            
                            <li>
                                <a href="/postgres/" >PostgreSQL</a>
                                
                            </li>
                            
                        
                    </ul>
                </div>
            </div>
            
        </div>
    </div>
</div>

<div class="container footer">
    
    <hr>
    <p class="text-muted">&copy; 2016 05Bit</p>
    
</div>
</body>
</html>